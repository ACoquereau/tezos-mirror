(executables
 (names test_requester test_fuzzing_requester)
 (libraries tezos-base
            tezos-base.unix
            tezos-test-helpers
            tezos-base-test-helpers
            tezos-stdlib-unix
            tezos-requester
            alcotest-lwt
            qcheck-alcotest)
 (flags (:standard -open Tezos_base__TzPervasives
                   -open Tezos_base_test_helpers
                   -open Tezos_stdlib
                   -open Tezos_requester)))

(alias
  (name buildtest)
  (deps test_requester.exe test_fuzzing_requester.exe))

(rule
 (alias runtest_requester)
 (action (run %{exe:test_requester.exe})))

(rule
 (alias runtest_fuzzing_requester)
 (action (run %{exe:test_fuzzing_requester.exe})))

(rule
 (alias runtest)
 (package tezos-requester)
 (deps (alias runtest_requester) (alias runtest_fuzzing_requester))
 (action (progn)))
