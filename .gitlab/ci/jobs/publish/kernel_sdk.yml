#
# Smart Rollup: Kernel SDK
#
# See src/kernel_sdk/RELEASE.md for more information

publish_kernel_sdk:
  extends:
    - .default_settings_template
  stage: manual
  image: "${PROD_AWS_ECR}/rust-toolchain:v1.0.3"
  rules:
  - when: manual
  allow_failure: true
  needs: []
  interruptible: false
  script:
    - make -f kernels.mk publish-sdk-deps
    - CC=clang make -f kernels.mk publish-sdk
  variables:
    CARGO_HOME: $CI_PROJECT_DIR/cargo
  cache:
    - paths:
        - cargo/